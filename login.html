<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Login | Training Gym</title>
<style>
  body{margin:0;font-family:Inter,Arial;background:linear-gradient(135deg,#0d1b2a,#1b263b);color:#fff;display:flex;align-items:center;justify-content:center;height:100vh}
  .card{background:rgba(255,255,255,0.04);padding:28px;border-radius:16px;width:100%;max-width:420px;box-shadow:0 8px 30px rgba(2,6,23,0.6)}
  h2{margin:0 0 12px}
  input{width:100%;padding:12px;margin-top:6px;border-radius:10px;border:none;outline:none}
  .btn{background:#00aaff;color:#00121b;padding:12px;border-radius:10px;border:none;margin-top:12px;font-weight:700;width:100%;cursor:pointer}
  .small{font-size:14px;color:#9fb5cc;margin-top:10px;text-align:center}
  .alert{padding:10px;border-radius:10px;margin-top:12px}
  .alert.success{background:#06d6a0;color:#012a19}
  .alert.error{background:#ef476f;color:#fff}
  a{color:#90e0ef;text-decoration:none}
</style>
</head>
<body>
  <div class="card">
    <h2>Welcome back</h2>
    <form id="loginForm">
      <label>Email <input id="email" type="email" required /></label>
      <label>Password <input id="password" type="password" required /></label>
      <button class="btn" type="submit">Login</button>
      <div id="msg"></div>
      <div class="small">No account? <a href="register.html">Create one</a></div>
    </form>
  </div>

<script>
  const API = "https://traininggym-backend.onrender.com";
  const form = document.getElementById('loginForm');
  const msg = document.getElementById('msg');
  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    msg.innerHTML='';
    const payload = { email: document.getElementById('email').value.trim(), password: document.getElementById('password').value };
    try{
      const res = await fetch(`${API}/login`, { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(payload) });
      const data = await res.json();
      if(res.ok && data.success){
        const user = { name: data.name || payload.email.split('@')[0], token: data.token || `${payload.email}-${Date.now()}` };
        localStorage.setItem('tg_user', JSON.stringify(user));
        msg.innerHTML = '<div class="alert success">Login successful. Redirectingâ€¦</div>';
        setTimeout(()=>location.href='index.html',900);
      } else {
        msg.innerHTML = `<div class="alert error">${data.message || 'Login failed'}</div>`;
      }
    }catch(err){
      msg.innerHTML = '<div class="alert error">Server error. Try later.</div>';
    }
  });
</script>
</body>
</html>
